#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Validando conventional commit..."

# Leer mensaje del commit
commit_msg=$(cat "$1")

# PatrÃ³n para conventional commits
pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,72}$"

if ! echo "$commit_msg" | grep -qE "$pattern"; then
    echo ""
    echo "âŒ COMMIT RECHAZADO!"
    echo ""
    echo "ğŸ“‹ Formato requerido: <type>[scope]: <description>"
    echo ""
    echo "ğŸ¯ Tipos vÃ¡lidos:"
    echo "  feat:     Nueva funcionalidad"
    echo "  fix:      CorrecciÃ³n de bug"
    echo "  docs:     DocumentaciÃ³n"
    echo "  style:    Formateo de cÃ³digo"
    echo "  refactor: RefactorizaciÃ³n"
    echo "  perf:     Mejora de rendimiento"
    echo "  test:     Tests"
    echo "  build:    Cambios en build/deps"
    echo "  ci:       CI/CD"
    echo "  chore:    Tareas de mantenimiento"
    echo ""
    echo "âœ… Ejemplos vÃ¡lidos:"
    echo "  feat(api): add user authentication"
    echo "  fix(domain): resolve null reference in Payment"
    echo "  docs: update API documentation"
    echo ""
    echo "âŒ Tu mensaje: \"$commit_msg\""
    exit 1
fi

echo "âœ… Commit vÃ¡lido!"
